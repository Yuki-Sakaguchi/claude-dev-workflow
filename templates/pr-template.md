# PR作成テンプレート

## 概要

Claude Codeが機能実装完了時に自動作成するPull Requestのテンプレートです。
`workflow/git-workflow.md`、`workflow/tdd-process.md`、`workflow/development-flow.md`と連携して、一貫性のあるPR管理を実現します。

## 基本PRテンプレート

### 機能実装PR

```markdown
## 概要
{実装した機能の概要}

Closes #{Issue番号}

## 変更内容
### 実装内容
- [ ] {実装項目1}
- [ ] {実装項目2}
- [ ] {実装項目3}

### ファイル変更
#### 新規作成
- `{新規ファイルパス}` - {ファイルの説明}

#### 変更
- `{変更ファイルパス}` - {変更内容の概要}

#### 削除
- `{削除ファイルパス}` - {削除理由}

## アクセプタンス基準
Issue #{番号} のアクセプタンス基準を全て満たしているか確認：

- [ ] {基準1}
- [ ] {基準2}
- [ ] {基準3}

## テスト結果
### 単体テスト（Vitest）
- [ ] 全テスト通過
- [ ] カバレッジ80%以上
- [ ] 新規テスト追加: {X}件

```bash
npm run test
# テスト結果サマリー
Tests:  X passed, X total
Coverage: XX.XX%
```

### コンポーネントテスト（Storybook）
- [ ] ストーリー作成完了
- [ ] インタラクションテスト通過
- [ ] アクセシビリティチェック通過

```bash
npm run storybook:build
# ビルド結果: 成功
```

### 統合テスト（該当する場合）
- [ ] API統合テスト通過
- [ ] データベース連携テスト通過
- [ ] 外部サービス連携テスト通過（該当する場合）

### E2Eテスト（重要機能の場合）
- [ ] 主要シナリオテスト通過
- [ ] ブラウザ互換性確認完了

```bash
npm run test:e2e
# Playwright結果: X passed, X total
```

## ドキュメント更新
`workflow/development-flow.md`に従って自動更新完了：

- [ ] README.md - 機能一覧更新
- [ ] docs/03_アクセプタンス基準.md - 完了チェック更新
- [ ] docs/api-spec.md - API仕様追加（該当する場合）
- [ ] CHANGELOG.md - 変更履歴追記

## 技術的詳細
### 実装アプローチ
{実装時の技術的判断や工夫した点}

### パフォーマンス影響
- [ ] パフォーマンス劣化なし
- [ ] 新規APIレスポンス時間: {X}ms以下
- [ ] バンドルサイズ影響: {+/-X}KB

### セキュリティ考慮事項
- [ ] 入力値バリデーション実装
- [ ] 認証・認可チェック実装（該当する場合）
- [ ] XSS/CSRF対策実装（該当する場合）

## スクリーンショット・デモ
### Before（変更前）
{変更前のスクリーンショットまたはGIF}

### After（変更後）
{変更後のスクリーンショットまたはGIF}

### 動作デモ
{主要な動作のGIFまたは説明}

## 動作確認環境
- [ ] ローカル環境での動作確認完了
- [ ] ステージング環境での動作確認完了（該当する場合）

## レビュー観点
以下の点を重点的にレビューしてください：

### コード品質
- [ ] 命名規則に従っているか
- [ ] DRY原則に従っているか
- [ ] エラーハンドリングが適切か
- [ ] TypeScript型定義が適切か

### 設計・アーキテクチャ
- [ ] 責務分離ができているか
- [ ] 将来の拡張性を考慮しているか
- [ ] 既存コードとの整合性があるか

### ユーザビリティ
- [ ] UI/UXが直感的か
- [ ] エラーメッセージが分かりやすいか
- [ ] アクセシビリティに配慮しているか

## 注意事項・補足
{レビュアーに伝えたい特記事項や注意点}

---
**関連Issue**: #{Issue番号}
**マイルストーン**: Phase1 / Phase2 / Phase3
**推定レビュー時間**: {X}分
```

## バグ修正PR

```markdown
## バグ修正概要
{修正したバグの概要}

Fixes #{Issue番号}

## 問題の詳細
### 原因
{バグの根本原因}

### 影響範囲
{バグが影響していた機能・ユーザー}

## 修正内容
### 修正アプローチ
{どのような方針で修正したか}

### 変更ファイル
- `{ファイルパス}` - {修正内容}

## 修正前後の比較
### Before（修正前の動作）
{問題があった時の動作説明}

### After（修正後の動作）
{修正後の正常な動作説明}

## テスト結果
### 回帰テスト
- [ ] 既存機能への影響なし
- [ ] 全テストスイート通過

### 修正対象テスト
- [ ] バグ再現テスト作成
- [ ] 修正後テスト通過
- [ ] エッジケーステスト追加

## 再発防止策
- [ ] 類似パターンの確認・修正
- [ ] テストケース追加
- [ ] ドキュメント・コメント追加

---
**関連Issue**: #{Issue番号}
**重要度**: Critical / High / Medium / Low
```

## 環境構築・設定PR

```markdown
## 設定・環境変更概要
{環境構築・設定変更の概要}

Closes #{Issue番号}

## 変更内容
### インフラ・デプロイ
- [ ] {設定項目1}
- [ ] {設定項目2}

### CI/CD
- [ ] ビルドパイプライン更新
- [ ] テスト自動化設定
- [ ] デプロイ自動化設定

### 開発環境
- [ ] 依存関係更新
- [ ] 設定ファイル追加・更新
- [ ] ドキュメント更新

## 設定ファイル変更
### 新規追加
- `{ファイルパス}` - {設定内容}

### 更新
- `{ファイルパス}` - {変更内容}

## 動作確認
### 各環境での確認
- [ ] ローカル環境: 正常動作確認
- [ ] ステージング環境: 正常動作確認（該当する場合）
- [ ] 本番環境: 正常動作確認（該当する場合）

### パフォーマンス確認
- [ ] ビルド時間: {変更前}s → {変更後}s
- [ ] テスト実行時間: {変更前}s → {変更後}s

## ロールバック手順
{問題発生時の戻し方}

---
**関連Issue**: #{Issue番号}
**影響範囲**: Local / Staging / Production
```

## Claude Code向け自動生成ルール

### PRタイトル形式
```
{type}: {簡潔な変更概要} (close #{issue番号})
```

**例**:
- `feat: ユーザーログイン機能実装 (close #12)`
- `fix: ログイン時のバリデーションエラー修正 (close #25)`
- `setup: CI/CD環境構築 (close #8)`

### ラベル自動付与
- `ready-for-review` - レビュー準備完了
- `feature` / `bugfix` / `setup` - 変更種別
- `needs-testing` - 手動テストが必要
- `breaking-change` - 破壊的変更あり

### 自動記入項目

**Claude Codeが自動記入する内容**:
```javascript
// PR自動生成時の情報収集
const prData = {
  issue: extractIssueNumber(),
  changes: analyzeFileChanges(),
  tests: runTestSuite(),
  coverage: calculateCoverage(),
  docs: checkDocumentUpdates(),
  screenshots: generateScreenshots() // 可能な場合
};
```

## レビュー基準

### 必須チェック項目（レビュアー用）
- [ ] アクセプタンス基準を全て満たしている
- [ ] 全テストが通過している
- [ ] ドキュメントが適切に更新されている
- [ ] セキュリティ要件を満たしている
- [ ] パフォーマンス劣化がない

### コードレビュー観点
- **機能性**: 仕様通りに動作するか
- **保守性**: 理解しやすく変更しやすいか
- **拡張性**: 将来の要件変更に対応できるか
- **効率性**: パフォーマンスに問題ないか

## Claude Code実行例

### 理想的な自動PR作成

**機能実装完了時の自動実行**:
```
issue #12 のユーザーログイン機能実装が完了しました。
以下の内容でPRを作成します：

✅ TDDサイクル完了（12件のテスト追加）
✅ Storybookストーリー作成完了
✅ 全テスト通過（カバレッジ: 87.3%）
✅ ドキュメント自動更新完了
✅ スクリーンショット生成完了

PR作成中...
```

### PR更新の自動実行
```bash
# レビュー指摘事項対応時
1. 指摘事項を修正
2. テスト再実行
3. PR説明更新
4. "ready-for-review"ラベル再付与
```

## 品質管理

### PR作成前チェックリスト（Claude Code自動実行）
- [ ] 全テスト通過確認
- [ ] コードカバレッジ目標達成
- [ ] リンター・フォーマッターチェック
- [ ] ドキュメント整合性確認
- [ ] セキュリティチェック

### 継続的改善
- **PR毎**: レビュー時間・指摘事項の記録
- **週次**: PR品質・プロセス改善の検討
- **月次**: テンプレート内容の見直し