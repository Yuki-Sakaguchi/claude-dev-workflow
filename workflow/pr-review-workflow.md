# PRレビュー対応ワークフロー

## 🎯 目的

GitHub PRのレビューコメントに対して、効率的かつ確実に対応するためのワークフローを定義します。

## 📋 基本フロー

```
レビュー受領 → 内容確認 → 修正計画 → 実装 → テスト → 追加コミット → レビュー依頼
```

## 🔄 ワークフロー詳細

### 1. レビュー確認フェーズ

#### レビュー取得
```bash
# PRのレビューコメント確認
gh pr view <PR番号> --comments

# 詳細なレビュー情報取得
gh api repos/:owner/:repo/pulls/<PR番号>/reviews
```

#### 分析項目
- [ ] **重要度の分類**
  - 🔴 Critical: セキュリティ・バグ・破壊的変更
  - 🟡 Important: パフォーマンス・設計・可読性
  - 🟢 Minor: スタイル・命名・ドキュメント

- [ ] **対応範囲の確認**
  - 修正が必要なファイル数
  - 影響範囲の把握
  - テスト追加の必要性

### 2. 修正計画フェーズ

#### 優先順位付け
1. **Critical** → 即座に対応
2. **Important** → 設計レビュー後対応
3. **Minor** → 効率的にまとめて対応

#### 修正計画作成
```markdown
## 修正計画

### Critical Issues
- [ ] [ファイル名:行数] 修正内容
- [ ] [ファイル名:行数] 修正内容

### Important Issues
- [ ] [ファイル名:行数] 修正内容
- [ ] [ファイル名:行数] 修正内容

### Minor Issues
- [ ] [ファイル名:行数] 修正内容
- [ ] [ファイル名:行数] 修正内容

### 追加作業
- [ ] テスト追加
- [ ] ドキュメント更新
- [ ] リファクタリング
```

### 3. 実装フェーズ

#### 実装順序
1. **Critical Issues**の修正
2. **テスト追加・修正**
3. **Important Issues**の修正
4. **Minor Issues**の修正
5. **ドキュメント更新**

#### 品質確保
```bash
# 各修正後に実行
npm run lint
npm run typecheck
npm run test

# 全体テスト
npm run test:coverage
```

### 4. コミット・プッシュフェーズ

#### コミットメッセージ規則
```
fix: [レビュー指摘] 修正内容の簡潔な説明

- 詳細な修正内容
- 関連するレビューコメントへの言及
- Co-authored-by: Reviewer Name <email@example.com>
```

#### プッシュ
```bash
# 既存のPRブランチに追加コミット
git push origin feature/branch-name
```

### 5. フォローアップフェーズ

#### レビュー依頼
- [ ] コメントで修正完了を報告
- [ ] 変更点の要約を記載
- [ ] 追加の確認事項があれば明記

#### 継続的改善
- [ ] 同様の指摘を受けないための改善策検討
- [ ] 開発プロセスの見直し
- [ ] 事前チェック項目の追加

## 🚀 カスタムコマンド対応

### `/pr-review` コマンド

#### 基本使用法
```bash
/pr-review <PR番号>
```

#### 高度な使用法
```bash
/pr-review <PR番号> --priority critical
/pr-review <PR番号> --auto-fix minor
/pr-review <PR番号> --include-tests
```

## 📊 品質指標

### 対応時間目標
- **Critical**: 2時間以内
- **Important**: 1日以内
- **Minor**: 3日以内

### 品質指標
- **修正漏れ**: 0件
- **追加バグ**: 0件
- **テストカバレッジ**: 修正前後で維持・向上

## 🔧 ツール・自動化

### 必須ツール
- **GitHub CLI** (`gh`): レビュー情報取得
- **Git**: バージョン管理
- **Linter/Formatter**: コード品質維持

### 推奨ツール
- **IDE拡張**: リアルタイム品質チェック
- **Pre-commit hooks**: コミット前品質確保
- **CI/CD**: 自動テスト実行

## 🆘 トラブルシューティング

### よくある問題

#### レビューコメントが取得できない
```bash
# 認証確認
gh auth status

# 再認証
gh auth login
```

#### 修正範囲が不明確
- レビュアーに具体的な修正方法を確認
- コードサンプルの提供依頼
- 設計方針の確認

#### テストが失敗する
1. 修正内容の影響範囲を再確認
2. テストケースの追加・修正
3. 段階的な修正とテスト実行

## 📋 チェックリスト

### 修正開始前
- [ ] レビューコメントの内容を理解
- [ ] 修正計画を作成
- [ ] 影響範囲を確認

### 修正実装中
- [ ] 各修正後にテスト実行
- [ ] コード品質チェック実行
- [ ] 関連ドキュメントの更新

### 修正完了後
- [ ] 全体テスト実行
- [ ] 修正内容の最終確認
- [ ] コミットメッセージの確認
- [ ] プッシュ実行

### フォローアップ
- [ ] レビュー依頼の送信
- [ ] 修正内容の説明
- [ ] 継続的改善の検討

---

**効率的なPRレビュー対応で、コードの品質向上とチーム協働を促進しましょう！**